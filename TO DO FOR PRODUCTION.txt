in gatewat, refactor UploadFile method to check certificate